#!/usr/bin/env ruby

class WallpaperJuggler
  def initialize(dir)
    @dir = dir
  end

  def empty?
    wallpapers.empty?
  end

  def set!
    system 'feh', '--bg-fill', *winners
  end

  def winners
    wallpapers[0..2]
  end

  private

  def wallpapers
    @wallpapers ||= Dir[@dir + '/*.{jpg,png}'].shuffle
  end
end

if $0 == __FILE__

  dir="#{ENV['HOME']}/Pictures/Wallpapers"
  juggle = WallpaperJuggler.new(dir)

  unless juggle.empty?
    juggle.set!
    puts juggle.winners.first
  else
    exit -1
  end

end

